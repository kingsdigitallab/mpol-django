{% extends 'periodicals/../periodicals/base.html' %}

{% block title %}{{ issue }}{% endblock %}
{% block meta_title %}{{ issue }}{% endblock %}

{% block main %}


    <section class="grid-container">
        <div class="grid-x">
            <div class="cell tabs" data-tabs id="issue-tabs">
                <ul class="menu subnav">
                    <li class="tabs-title is-active"><a href="#contents" aria-selected="true">Contents</a></li>
                    <li class="tabs-title"><a data-tabs-target="pages" href="#pages">Pages</a></li>
                    <li class="tabs-title"><a data-tabs-target="articles" href="#articles">Articles</a></li>
                    <li class="tabs-title"><a data-tabs-target="ads" href="#ads">Ads</a></li>
                </ul>
                <ul class="menu align-right">
                    <li><a href="{{ issue.pdf.url }}"><i class="fa fa-file-text-o" aria-hidden="true"></i> PDF</a></li>
                    <!-- *** Removed to have one option ***
                <li><a href="{{ issue.pdf.url }}" download="{{ issue }}"><i class="fa fa-download" aria-hidden="true"></i> Download PDF</a></li>
                -->
                </ul>
            </div>
        </div>
    </section>

    <div class="grid-container tabs-content" data-tabs-content="issue-tabs">

        <!-- *** TODO: Data to be added *** -->
        <section class="tabs-panel is-active" id="contents">
            <div class="grid-x">
                <div class="cell">
                    <h2>Contents</h2>
                </div>
                <div class="cell">
                    <table class="stack unstriped">
                        <thead>
                        <tr>
                            <th>Page</th>
                            <th>Category</th>
                            <th>Title</th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for article in issue.articles %}
                            {% with page=article.page publication=article.page.issue.publication issue=article.page.issue %}
                                <tr>
                                    <td>{{ article.page.number }}</td>
                                    <td>{{ article.article_type }}</td>
                                    <td>
                                        <a href="{% url 'article-detail' publication_slug=publication.slug issue_slug=issue.slug number=page.number article_slug=article.slug%}">{{ article.title }}</a>
                                    </td>
                                </tr>
                            {% endwith %}
                        {% endfor %}

                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <section class="tabs-panel" id="pages">
            <div class="grid-x">
                <div class="cell">
                    <h3 class="underline">Pages</h3>
                </div>
            </div>

            <div class="grid-x grid-padding-x grid-padding-y medium-up-2 large-up-4 container">
                {% for page in issue.pages.all %}
                    <div class="cell">
                        <div class="card">
                            <a href="{{ page.url }}">
                                <div class="card-image">
                                    <img src="{{ page.image.url }}">
                                </div>
                                <div class="card-section overlay">
                                    <h3>Page {{ page.number }}</h3>
                                    <div class="card-footer">
                                        {{ page.number_of_articles }} Articles
                                    </div>
                                </div>
                            </a>
                            {% if request.user.is_staff %}
                                <div class="card-divider">
                                    <a href="/admin/periodicals/page/{{ page.id }}/change/" class="card-footer-item">Edit</a>
                                </div>
                            {% endif %}
                        </div>
                    </div>
                {% endfor %}
            </div>
        </section>

        <section class="tabs-panel" id="articles">
            <div class="gird-x">
                <div class="cell">
                    <h3 class="underline">Articles</h3>
                </div>
            </div>

            <div class="grid-x grid-padding-x grid-padding-y medium-up-2 large-up-4 container"
                 data-equalizer="card-article" data-equalize-on="medium" data-equalize-by-row="true">
                {% for article in issue.articles %}
                    <div class="cell">
                        <div class="card" data-equalizer-watch="card-article">
                            <a href="{{ article.url }}">
                                <div class="card-image">
                                    <img src="{{ article.title_image.url }}">
                                </div>
                                <div class="card-section overlay">
                                    <h3>{{ article|title }}</h3>

                                    <div class="card-footer">
                                        Page {{ article.page.number }}
                                    </div>
                                </div>
                            </a>
                            {% if request.user.is_staff %}
                                <div class="card-divider">
                                    <a href="/admin/periodicals/article/{{ article.id }}/change/"
                                       class="card-footer-item">Edit</a>
                                </div>
                            {% endif %}
                        </div>
                    </div>
                {% endfor %}
            </div>
        </section>

        <section class="tabs-panel" id="ads">
            <div class="gird-x">
                <div class="cell">
                    <h3 class="underline">Ads</h3>
                </div>
            </div>

            <div class="grid-x grid-padding-x grid-padding-y medium-up-2 large-up-4 container"
                 data-equalizer="card-article" data-equalize-on="medium" data-equalize-by-row="true">
                {% for ad in issue.ads %}
                    <div class="cell">
                        <div class="card" data-equalizer-watch="card-ad">
                            <a href="{{ ad.url }}">
                                <div class="card-image">
                                    <img src="{{ ad.title_image.url }}">
                                </div>
                                <div class="card-section overlay">
                                    <h3>{{ ad|title }}</h3>

                                    <div class="card-footer">
                                        Page {{ ad.page.number }}
                                    </div>
                                </div>
                            </a>
                            {% if request.user.is_staff %}
                                <div class="card-divider">
                                    <a href="/admin/periodicals/article/{{ ad.id }}/change/"
                                       class="card-footer-item">Edit</a>
                                </div>
                            {% endif %}
                        </div>
                    </div>
                {% endfor %}
            </div>
        </section>

    </div>
{% endblock %}