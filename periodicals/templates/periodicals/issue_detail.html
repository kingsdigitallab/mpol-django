{% extends 'periodicals/base.html' %}
{% load periodicals_tags  %}
{% block title %}{{ issue.publication}}, {{ issue.issue_date }}{% endblock %}
{% block meta_title %}{{ issue.publication}}, {{ issue.issue_date }}{% endblock %}

{% block main %}
<section class="grid-container">
    <div class="grid-x">
        <div class="cell minus-margin-top">
            <ul class="menu align-right">
                {% get_request_parameters as search_params %}
                {% if search_params %}
                <li><a href="{% url 'search' %}?{{ search_params }}"><i class="fa fa-arrow-left" aria-hidden="true"></i> Back to results</a> </li>
                {% endif %}

            </ul>
            <ul class="menu align-right">
                    <li><a href="{{ issue.pdf.url }}"><i class="fa fa-file-text-o" aria-hidden="true"></i> PDF</a></li>
                    <!-- *** Removed to have one option ***
                <li><a href="{{ issue.pdf.url }}" download="{{ issue }}"><i class="fa fa-download" aria-hidden="true"></i> Download PDF</a></li>
                -->
             </ul>
        </div>
    </div>
</section>


    <section class="grid-container">
        <div class="grid-x">
            <div class="cell tabs" data-tabs id="issue-tabs">
                Contents
                <ul class="menu align-right">
                    <li class="tabs-title is-active"><a href="#list" aria-selected="true"><i class="fa fa-list-ul" aria-hidden="true"></i> List</a></li>
                    <li class="tabs-title"><a data-tabs-target="grid" href="#grid"><i class="fa fa-th" aria-hidden="true"></i> Grid</a></li>
                </ul>

            </div>
        </div>
    </section>

    <div class="grid-container tabs-content" data-tabs-content="issue-tabs">

        <!-- *** TODO: Data to be added *** -->
        <section class="tabs-panel is-active" id="list">
            <div class="grid-x">
                <div class="cell">
                    <table class="stack unstriped">
                        <thead>
                        <tr>
                            <th>Page</th>
                            <th>Category</th>
                            <th>Title</th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for article in issue.articles %}
                            {% with page=article.page publication=article.page.issue.publication issue=article.page.issue %}
                            
                                <tr>
                            
                                    <td>{{ article.page.number }}</td>
                                    <td>{{ article.article_type }}</td>
                                    <td><a href="{% url 'article-detail' publication_slug=publication.slug issue_slug=issue.slug number=page.number article_slug=article.slug%}">{{ article.title }}</a></td>

                                </tr>
                               
                            {% endwith %}
                        {% endfor %}

                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <section class="tabs-panel" id="grid">
            <div class="grid-x grid-padding-x grid-padding-y medium-up-2 large-up-4 container">
                {% for page in issue.pages.all %}
                    <div class="cell">
                        <div class="card">
                            <a href="{{ page.url }}">
                                <div class="card-image">
                                    <img src="{{ page.image.url }}">
                                </div>
                                <div class="card-section overlay">
                                    <h3>Page {{ page.number }}</h3>
                                    <div class="card-footer">
                                         { Article and/or Ad Title/s }

                                    </div>
                                </div>
                            </a>
                            {% if request.user.is_staff %}
                                <div class="card-divider">
                                    <a href="/admin/periodicals/page/{{ page.id }}/change/" class="card-footer-item">Edit</a>
                                </div>
                            {% endif %}
                        </div>
                    </div>
                {% endfor %}
            </div>
        </section>
    </div>
{% endblock %}