{% extends 'periodicals/base.html' %}
{% load periodicals_tags %}

{% block meta_title %}
    {{ publication }}
{% endblock %}

{% block title %}
    {{ publication }}
{% endblock %}

{% block main %}

<div class="row">
    <div class="small-12 columns minus-margin-top">
         <ul class="menu float-left">
            <li>
                <a href="{% url 'publication-list' %}" ><i class="fa fa-arrow-left" aria-hidden="true"></i> Back to Explore</a>
            </li>
        </ul>
    </div>
</div>

{% if publication.description %}
<section>
    <div class="row">
        <div class="small-12 columns">
            <h3>Description</h3> 

            <div class="description-trunk">
                {{ publication.description|truncatewords_html:40 }}

                <a class="read-more" data-target="#description-full">Read more</a>
            </div>

            <div class="description-full" id="description-full">
                {{ publication.description }}
            </div>
        </div>
    </div>
</section>
{% endif %}


<!-- Start example mobile accordion -->


<section class="tab-to-accordion">
    <div class="row">
        <div class="small-12 columns">
    <ul class="menu subnav accordion" data-multi-expand="true" data-allow-all-closed="true" data-responsive-accordion-tabs="accordion medium-tabs">
                                    <li>
                                    <h2>Years</h2>
                                </li>
      <li class="accordion-item is-active" data-accordion-item>
        <a class="accordion-title" href="/periodicals/mob/1856/">
         1856 <span>(2 issues)</span></a>
        <div class="accordion-content" data-tab-content >
          <div class="row small-up-2 medium-up-3 large-up-5" data-equalizer="cards" data-equalize-by-row="true" data-equalize-on="medium" data-resize="cards" data-mutate="cards" data-e="8orhbx-e">
                        
                        <div class="column column-block" data-equalizer-watch="cards">
                            <div class="card">
                                <a href="/periodicals/mob/issues/mob_01111856/">
                                    <div class="card-image">
                                        <img src="/static/media/periodicals/119-MOB-1856-11-01-001-SINGLE/Pg001.png" alt="The Masonic Observer">
                                    </div>
                                    <div class="card-section overlay">
                                        <h3 class="small-caps">The Masonic Observer</h3>
                                        <h3 class="small-caps">Nov. 1, 1856</h3>
                                        <div class="card-footer">
                                            10 Articles, 8 Pages
                                        </div>
                                    </div>
                                </a>
                                
                            </div>
                        </div>
                        
                        <div class="column column-block" data-equalizer-watch="cards">
                            <div class="card">
                                <a href="/periodicals/mob/issues/mob_01121856/">
                                    <div class="card-image">
                                        <img src="/static/media/periodicals/119-MOB-1856-12-01-001-SINGLE/Pg001.png" alt="The Masonic Observer">
                                    </div>
                                    <div class="card-section overlay">
                                        <h3 class="small-caps">The Masonic Observer</h3>
                                        <h3 class="small-caps">Dec. 1, 1856</h3>
                                        <div class="card-footer">
                                            28 Articles, 18 Pages
                                        </div>
                                    </div>
                                </a>
                                
                            </div>
                        </div>
                        
                    </div>
        </div>
      </li>
      <li class="accordion-item" data-accordion-item>
        <a class="accordion-title" href="/periodicals/mob/1856/">
         1857 <span>(5 issues)</span></a>
        <div class="accordion-content" data-tab-content>
          <div class="row small-up-2 medium-up-3 large-up-5 equalize-me-again" data-equalizer="cards" data-equalize-by-row="true" data-equalize-on="medium" data-resize="cards" data-mutate="cards" data-e="531s3z-e">
    
    <div class="column column-block" data-equalizer-watch="cards">
        <div class="card">
            <a href="/periodicals/mob/issues/mob_01031857/">
                <div class="card-image">
                    <img src="/static/media/periodicals/119-MOB-1857-03-01-001-SINGLE/Pg001.png">
                </div>
                <div class="card-section overlay">
                    <h3 class="small-caps"></h3>
                    <h3 class="small-caps">March 1, 1857</h3>
                    <div class="card-footer">
                        24 Articles spanning 16 Pages
                    </div>
                </div>
            </a>
            
        </div>
    </div>
    
    <div class="column column-block" data-equalizer-watch="cards">
        <div class="card">
            <a href="/periodicals/mob/issues/mob_20031857/">
                <div class="card-image">
                    <img src="/static/media/periodicals/119-MOB-1857-03-20-001-SINGLE/Pg001.png">
                </div>
                <div class="card-section overlay">
                    <h3 class="small-caps"></h3>
                    <h3 class="small-caps">March 20, 1857</h3>
                    <div class="card-footer">
                        15 Articles spanning 11 Pages
                    </div>
                </div>
            </a>
            
        </div>
    </div>
    
    <div class="column column-block" data-equalizer-watch="cards">
        <div class="card">
            <a href="/periodicals/mob/issues/mob_20061857/">
                <div class="card-image">
                    <img src="/static/media/periodicals/119-MOB-1857-06-20-001-SINGLE/Pg001.png">
                </div>
                <div class="card-section overlay">
                    <h3 class="small-caps"></h3>
                    <h3 class="small-caps">June 20, 1857</h3>
                    <div class="card-footer">
                        21 Articles spanning 20 Pages
                    </div>
                </div>
            </a>
            
        </div>
    </div>
    
    <div class="column column-block" data-equalizer-watch="cards">
        <div class="card">
            <a href="/periodicals/mob/issues/mob_20091857/">
                <div class="card-image">
                    <img src="/static/media/periodicals/119-MOB-1857-09-20-001-SINGLE/Pg001.png">
                </div>
                <div class="card-section overlay">
                    <h3 class="small-caps"></h3>
                    <h3 class="small-caps">Sept. 20, 1857</h3>
                    <div class="card-footer">
                        18 Articles spanning 20 Pages
                    </div>
                </div>
            </a>
            
        </div>
    </div>
    
    <div class="column column-block" data-equalizer-watch="cards">
        <div class="card">
            <a href="/periodicals/mob/issues/mob_20121857/">
                <div class="card-image">
                    <img src="/static/media/periodicals/119-MOB-1857-12-20-001-SINGLE/Pg001.png">
                </div>
                <div class="card-section overlay">
                    <h3 class="small-caps"></h3>
                    <h3 class="small-caps">Dec. 20, 1857</h3>
                    <div class="card-footer">
                        15 Articles spanning 16 Pages
                    </div>
                </div>
            </a>
            
        </div>
    </div>
    
</div>
        </div>
      </li>
      <li class="accordion-item" data-accordion-item>
        <a class="accordion-title" href="/periodicals/mob/1856/">
         1858 <span>(4 issues)</span></a>
        <div class="accordion-content" data-tab-content>
          <div class="row small-up-2 medium-up-3 large-up-5 equalize-me-again" data-equalizer="cards" data-equalize-by-row="true" data-equalize-on="medium" data-resize="cards" data-mutate="cards" data-e="eq5tcp-e">
    
    <div class="column column-block" data-equalizer-watch="cards">
        <div class="card">
            <a href="/periodicals/mob/issues/mob_20031858/">
                <div class="card-image">
                    <img src="/static/media/periodicals/119-MOB-1858-03-20-001-SINGLE/Pg001.png">
                </div>
                <div class="card-section overlay">
                    <h3 class="small-caps"></h3>
                    <h3 class="small-caps">March 20, 1858</h3>
                    <div class="card-footer">
                        13 Articles spanning 16 Pages
                    </div>
                </div>
            </a>
            
        </div>
    </div>
    
    <div class="column column-block" data-equalizer-watch="cards">
        <div class="card">
            <a href="/periodicals/mob/issues/mob_20061858/">
                <div class="card-image">
                    <img src="/static/media/periodicals/119-MOB-1858-06-20-001-SINGLE/Pg001.png">
                </div>
                <div class="card-section overlay">
                    <h3 class="small-caps"></h3>
                    <h3 class="small-caps">June 20, 1858</h3>
                    <div class="card-footer">
                        25 Articles spanning 20 Pages
                    </div>
                </div>
            </a>
            
        </div>
    </div>
    
    <div class="column column-block" data-equalizer-watch="cards">
        <div class="card">
            <a href="/periodicals/mob/issues/mob_20091858/">
                <div class="card-image">
                    <img src="/static/media/periodicals/119-MOB-1858-09-20-001-SINGLE/Pg001.png">
                </div>
                <div class="card-section overlay">
                    <h3 class="small-caps"></h3>
                    <h3 class="small-caps">Sept. 20, 1858</h3>
                    <div class="card-footer">
                        26 Articles spanning 24 Pages
                    </div>
                </div>
            </a>
            
        </div>
    </div>
    
    <div class="column column-block" data-equalizer-watch="cards">
        <div class="card">
            <a href="/periodicals/mob/issues/mob_20121858/">
                <div class="card-image">
                    <img src="/static/media/periodicals/119-MOB-1858-12-20-001-SINGLE/Pg001.png">
                </div>
                <div class="card-section overlay">
                    <h3 class="small-caps"></h3>
                    <h3 class="small-caps">Dec. 20, 1858</h3>
                    <div class="card-footer">
                        19 Articles spanning 36 Pages
                    </div>
                </div>
            </a>
            
        </div>
    </div>
    
</div>
        </div>
      </li>
    </ul>
    </div>
    </div>
</section>

<!-- End example mobile accordion -->
{% regroup publication.issues.all by issue_date.year as year_list %}
<section>
    <div class="row">
        <div class="small-12 columns">
            <div id="sticky">
                <div data-sticky-container>
                    <div class="sticky" data-sticky-on="small" data-sticky data-margin-top="0" data-anchor="sticky">
                        <nav data-magellan>
                            <ul class="menu subnav" id="publication-year-switcher">
                                <li>
                                    <h2>Years</h2>
                                </li>

                                {% for year, issues_in_year in year_list %}
                                <li>
                                    <a {% if forloop.first %}class='is-active' {% endif %}href="{% url 'publication-issue-ajax' slug=publication.slug year=year %}">
                                        {{ year }} <span>({{ issues_in_year|length }} issues)</span>
                                    </a>
                                </li>
                                {% endfor %}
                            </ul>
                        </nav>
                    </div>
                </div>
                <section id="issues-ajax">
                    <div class="row">
                        <div class="small-12 columns">
                            <h3>
                                {{ selected_year }} 
                                <span>({{ selected_issues|length }} issues)</span>
                                {% if not forloop.last %} {% endif %}
                            </h3>
                        </div>
                    </div>
                    <div class="row small-up-2 medium-up-3 large-up-5" data-equalizer="cards" data-equalize-by-row="true" data-equalize-on="medium">
                        {% for issue in selected_issues %}
                        <div class="column column-block" data-equalizer-watch="cards">
                            <div class="card">
                                <a href="{{ issue.url }}">
                                    <div class="card-image">
                                        <img src="{% thumbnail issue.pages.all.0.image.url %}" alt="{{ publication }}">
                                    </div>
                                    <div class="card-section overlay">
                                        <h3 class="small-caps">{{ publication }}</h3>
                                        <h3 class="small-caps">{{ issue.issue_date }}</h3>
                                        <div class="card-footer">
                                            {{ issue.articles.count }} Articles, {{ issue.pages.count }} Pages
                                        </div>
                                    </div>
                                </a>
                                {% if request.user.is_staff %}
                                <div class="card-divider">
                                    <a href="/admin/periodicals/issue/{{ issue.id }}/change/" class="card-footer-item">Edit</a>
                                </div>
                                {% endif %}
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </section>
            </div>
        </div>
    </div>    
</section>
{% endblock %}